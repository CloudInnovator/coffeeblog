{"ast":null,"code":"import React,{useState,useEffect}from'react';import{supabase}from'../lib/supabase';import'./ArticleComments.css';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const ArticleComments=_ref=>{let{articleId,articleTitle}=_ref;const[comments,setComments]=useState([]);const[newComment,setNewComment]=useState('');const[isAnonymous,setIsAnonymous]=useState(false);const[isLoading,setIsLoading]=useState(false);const[isSubmitting,setIsSubmitting]=useState(false);useEffect(()=>{loadComments();},[articleId]);const loadComments=async()=>{setIsLoading(true);try{const{data,error}=await supabase.from('article_comments').select('*').eq('article_id',articleId).order('created_at',{ascending:false});if(error)throw error;setComments(data||[]);}catch(error){console.error('Error loading comments:',error);}finally{setIsLoading(false);}};const handleSubmitComment=async e=>{e.preventDefault();if(!newComment.trim())return;setIsSubmitting(true);try{const{data:{user}}=await supabase.auth.getUser();if(!user){alert('Please sign in to comment');return;}// Get user profile for username\nconst{data:profile}=await supabase.from('profiles').select('username').eq('id',user.id).single();const{error}=await supabase.from('article_comments').insert([{user_id:user.id,article_id:articleId,article_title:articleTitle,content:newComment.trim(),username:isAnonymous?'Anonymous':(profile===null||profile===void 0?void 0:profile.username)||'User',is_anonymous:isAnonymous}]);if(error)throw error;setNewComment('');setIsAnonymous(false);await loadComments();}catch(error){console.error('Error submitting comment:',error);alert('Error submitting comment. Please try again.');}finally{setIsSubmitting(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"article-comments\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Comments (\",comments.length,\")\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitComment,className:\"comment-form\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:\"Share your thoughts...\",rows:4,className:\"comment-input\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"comment-form-actions\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"anonymous-checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isAnonymous,onChange:e=>setIsAnonymous(e.target.checked)}),\"Post anonymously\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isSubmitting||!newComment.trim(),className:\"submit-comment-btn\",children:isSubmitting?'Posting...':'Post Comment'})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comments-list\",children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading comments...\"}):comments.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-comments\",children:\"No comments yet. Be the first to comment!\"}):comments.map(comment=>/*#__PURE__*/_jsxs(\"div\",{className:\"comment\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"comment-author\",children:comment.username}),/*#__PURE__*/_jsx(\"span\",{className:\"comment-date\",children:new Date(comment.created_at).toLocaleDateString()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-content\",children:comment.content})]},comment.id))})]});};export default ArticleComments;","map":{"version":3,"names":["React","useState","useEffect","supabase","jsxs","_jsxs","jsx","_jsx","ArticleComments","_ref","articleId","articleTitle","comments","setComments","newComment","setNewComment","isAnonymous","setIsAnonymous","isLoading","setIsLoading","isSubmitting","setIsSubmitting","loadComments","data","error","from","select","eq","order","ascending","console","handleSubmitComment","e","preventDefault","trim","user","auth","getUser","alert","profile","id","single","insert","user_id","article_id","article_title","content","username","is_anonymous","className","children","length","onSubmit","value","onChange","target","placeholder","rows","type","checked","disabled","map","comment","Date","created_at","toLocaleDateString"],"sources":["/home/brave/Documents/weekendproject/coffeeblog/src/components/ArticleComments.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { supabase } from '../lib/supabase';\nimport './ArticleComments.css';\n\ninterface Comment {\n  id: string;\n  content: string;\n  created_at: string;\n  username: string;\n  is_anonymous: boolean;\n}\n\ninterface ArticleCommentsProps {\n  articleId: string;\n  articleTitle: string;\n}\n\nconst ArticleComments: React.FC<ArticleCommentsProps> = ({ articleId, articleTitle }) => {\n  const [comments, setComments] = useState<Comment[]>([]);\n  const [newComment, setNewComment] = useState('');\n  const [isAnonymous, setIsAnonymous] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  useEffect(() => {\n    loadComments();\n  }, [articleId]);\n\n  const loadComments = async () => {\n    setIsLoading(true);\n    try {\n      const { data, error } = await supabase\n        .from('article_comments')\n        .select('*')\n        .eq('article_id', articleId)\n        .order('created_at', { ascending: false });\n\n      if (error) throw error;\n      setComments(data || []);\n    } catch (error) {\n      console.error('Error loading comments:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSubmitComment = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newComment.trim()) return;\n\n    setIsSubmitting(true);\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) {\n        alert('Please sign in to comment');\n        return;\n      }\n\n      // Get user profile for username\n      const { data: profile } = await supabase\n        .from('profiles')\n        .select('username')\n        .eq('id', user.id)\n        .single();\n\n      const { error } = await supabase\n        .from('article_comments')\n        .insert([\n          {\n            user_id: user.id,\n            article_id: articleId,\n            article_title: articleTitle,\n            content: newComment.trim(),\n            username: isAnonymous ? 'Anonymous' : (profile?.username || 'User'),\n            is_anonymous: isAnonymous\n          }\n        ]);\n\n      if (error) throw error;\n\n      setNewComment('');\n      setIsAnonymous(false);\n      await loadComments();\n    } catch (error) {\n      console.error('Error submitting comment:', error);\n      alert('Error submitting comment. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"article-comments\">\n      <h3>Comments ({comments.length})</h3>\n      \n      <form onSubmit={handleSubmitComment} className=\"comment-form\">\n        <textarea\n          value={newComment}\n          onChange={(e) => setNewComment(e.target.value)}\n          placeholder=\"Share your thoughts...\"\n          rows={4}\n          className=\"comment-input\"\n        />\n        <div className=\"comment-form-actions\">\n          <label className=\"anonymous-checkbox\">\n            <input\n              type=\"checkbox\"\n              checked={isAnonymous}\n              onChange={(e) => setIsAnonymous(e.target.checked)}\n            />\n            Post anonymously\n          </label>\n          <button\n            type=\"submit\"\n            disabled={isSubmitting || !newComment.trim()}\n            className=\"submit-comment-btn\"\n          >\n            {isSubmitting ? 'Posting...' : 'Post Comment'}\n          </button>\n        </div>\n      </form>\n\n      <div className=\"comments-list\">\n        {isLoading ? (\n          <div className=\"loading\">Loading comments...</div>\n        ) : comments.length === 0 ? (\n          <div className=\"no-comments\">No comments yet. Be the first to comment!</div>\n        ) : (\n          comments.map((comment) => (\n            <div key={comment.id} className=\"comment\">\n              <div className=\"comment-header\">\n                <span className=\"comment-author\">{comment.username}</span>\n                <span className=\"comment-date\">\n                  {new Date(comment.created_at).toLocaleDateString()}\n                </span>\n              </div>\n              <div className=\"comment-content\">{comment.content}</div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ArticleComments;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}